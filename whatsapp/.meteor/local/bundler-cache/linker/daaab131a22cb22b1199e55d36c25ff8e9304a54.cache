[{"type":"js","data":"/* Imports for global scope */\n\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\n$ = Package.jquery.$;\njQuery = Package.jquery.jQuery;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\n_ = Package.underscore._;\nDDP = Package['ddp-client'].DDP;\nmeteorInstall = Package.modules.meteorInstall;\nBuffer = Package.modules.Buffer;\nprocess = Package.modules.process;\nSymbol = Package['ecmascript-runtime'].Symbol;\nMap = Package['ecmascript-runtime'].Map;\nSet = Package['ecmascript-runtime'].Set;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nAutoupdate = Package.autoupdate.Autoupdate;\nReload = Package.reload.Reload;\n\n","servePath":"/packages/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"client\":{\"scripts\":{\"lib\":{\"app.js\":[\"angular-animate\",\"angular-meteor\",\"angular-meteor-auth\",\"angular-moment\",\"angular-sanitize\",\"angular-ui-router\",\"ionic-scripts\",\"angular\",\"angular-ecmascript/module-loader\",\"meteor/meteor\",\"../controllers/chats.controller\",\"../controllers/chat.controller\",\"../controllers/confirmation.controller\",\"../controllers/login.controller\",\"../controllers/new-chat.controller\",\"../controllers/profile.controller\",\"../controllers/settings.controller\",\"../directives/input.directive\",\"../filters/calendar.filter\",\"../filters/chat-name.filter\",\"../filters/chat-picture.filter\",\"../services/new-chat.service\",\"../routes\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/lib/app.js                                                                     //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nmodule.import('angular-animate');module.import('angular-meteor');module.import('angular-meteor-auth');module.import('angular-moment');module.import('angular-sanitize');module.import('angular-ui-router');module.import('ionic-scripts');var Angular;module.import('angular',{\"default\":function(v){Angular=v}});var Loader;module.import('angular-ecmascript/module-loader',{\"default\":function(v){Loader=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var ChatsCtrl;module.import('../controllers/chats.controller',{\"default\":function(v){ChatsCtrl=v}});var ChatCtrl;module.import('../controllers/chat.controller',{\"default\":function(v){ChatCtrl=v}});var ConfirmationCtrl;module.import('../controllers/confirmation.controller',{\"default\":function(v){ConfirmationCtrl=v}});var LoginCtrl;module.import('../controllers/login.controller',{\"default\":function(v){LoginCtrl=v}});var NewChatCtrl;module.import('../controllers/new-chat.controller',{\"default\":function(v){NewChatCtrl=v}});var ProfileCtrl;module.import('../controllers/profile.controller',{\"default\":function(v){ProfileCtrl=v}});var SettingsCtrl;module.import('../controllers/settings.controller',{\"default\":function(v){SettingsCtrl=v}});var InputDirective;module.import('../directives/input.directive',{\"default\":function(v){InputDirective=v}});var CalendarFilter;module.import('../filters/calendar.filter',{\"default\":function(v){CalendarFilter=v}});var ChatNameFilter;module.import('../filters/chat-name.filter',{\"default\":function(v){ChatNameFilter=v}});var ChatPictureFilter;module.import('../filters/chat-picture.filter',{\"default\":function(v){ChatPictureFilter=v}});var NewChatService;module.import('../services/new-chat.service',{\"default\":function(v){NewChatService=v}});var Routes;module.import('../routes',{\"default\":function(v){Routes=v}});// Libs\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 // 4\n                                                                                                 // 5\n                                                                                                 // 6\n                                                                                                 // 7\n                                                                                                 // 8\n                                                                                                 // 9\n                                                                                                 // 10\n                                                                                                 // 11\n                                                                                                 //\n// Modules                                                                                       // 13\n                                                                                                 // 14\n                                                                                                 // 15\n                                                                                                 // 16\n                                                                                                 // 17\n                                                                                                 // 18\n                                                                                                 // 19\n                                                                                                 // 20\n                                                                                                 // 21\n                                                                                                 // 22\n                                                                                                 // 23\n                                                                                                 // 24\n                                                                                                 // 25\n                                                                                                 // 26\n                                                                                                 //\nvar App = 'Whatsapp';                                                                            // 28\n                                                                                                 //\n// App                                                                                           // 30\nAngular.module(App, ['angular-meteor', 'angular-meteor.auth', 'angularMoment', 'ionic']);        // 31\n                                                                                                 //\nnew Loader(App).load(ChatsCtrl).load(ChatCtrl).load(ConfirmationCtrl).load(LoginCtrl).load(NewChatCtrl).load(ProfileCtrl).load(SettingsCtrl).load(InputDirective).load(CalendarFilter).load(ChatNameFilter).load(ChatPictureFilter).load(NewChatService).load(Routes);\n                                                                                                 //\n// Startup                                                                                       // 53\nif (Meteor.isCordova) {                                                                          // 54\n  Angular.element(document).on('deviceready', onReady);                                          // 55\n} else {                                                                                         // 56\n  Angular.element(document).ready(onReady);                                                      // 58\n}                                                                                                // 59\n                                                                                                 //\nfunction onReady() {                                                                             // 61\n  Angular.bootstrap(document, [App]);                                                            // 62\n}                                                                                                // 63\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"controllers\":{\"chat.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"ionic-scripts\",\"meteor/underscore\",\"meteor/meteor\",\"meteor/okland:camera-ui\",\"angular-ecmascript/module-helpers\",\"../../../lib/collections\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/chat.controller.js                                                 //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Ionic;module.import('ionic-scripts',{\"default\":function(v){Ionic=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var MeteorCameraUI;module.import('meteor/okland:camera-ui',{\"MeteorCameraUI\":function(v){MeteorCameraUI=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});var Chats,Messages;module.import('../../../lib/collections',{\"Chats\":function(v){Chats=v},\"Messages\":function(v){Messages=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 // 4\n                                                                                                 // 5\n                                                                                                 // 6\n                                                                                                 //\nvar ChatCtrl = function (_Controller) {                                                          //\n  _inherits(ChatCtrl, _Controller);                                                              //\n                                                                                                 //\n  function ChatCtrl() {                                                                          // 9\n    _classCallCheck(this, ChatCtrl);                                                             // 9\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Controller.apply(this, arguments));            // 9\n                                                                                                 //\n    _this.chatId = _this.$stateParams.chatId;                                                    // 12\n    _this.isIOS = Ionic.Platform.isWebView() && Ionic.Platform.isIOS();                          // 13\n    _this.isCordova = Meteor.isCordova;                                                          // 14\n                                                                                                 //\n    _this.helpers({                                                                              // 16\n      messages: function () {                                                                    // 17\n        function messages() {                                                                    // 16\n          return Messages.find({ chatId: this.chatId });                                         // 18\n        }                                                                                        // 19\n                                                                                                 //\n        return messages;                                                                         // 16\n      }(),                                                                                       // 16\n      data: function () {                                                                        // 20\n        function data() {                                                                        // 16\n          return Chats.findOne(this.chatId);                                                     // 21\n        }                                                                                        // 22\n                                                                                                 //\n        return data;                                                                             // 16\n      }()                                                                                        // 16\n    });                                                                                          // 16\n                                                                                                 //\n    _this.autoScroll();                                                                          // 25\n    return _this;                                                                                // 9\n  }                                                                                              // 26\n                                                                                                 //\n  ChatCtrl.prototype.sendPicture = function () {                                                 //\n    function sendPicture() {                                                                     //\n      var _this2 = this;                                                                         // 28\n                                                                                                 //\n      MeteorCameraUI.getPicture({}, function (err, data) {                                       // 29\n        if (err) return _this2.handleError(err);                                                 // 30\n                                                                                                 //\n        _this2.callMethod('newMessage', {                                                        // 32\n          picture: data,                                                                         // 33\n          type: 'picture',                                                                       // 34\n          chatId: _this2.chatId                                                                  // 35\n        });                                                                                      // 32\n      });                                                                                        // 37\n    }                                                                                            // 38\n                                                                                                 //\n    return sendPicture;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.sendMessage = function () {                                                 //\n    function sendMessage() {                                                                     //\n      if (_.isEmpty(this.message)) return;                                                       // 41\n                                                                                                 //\n      this.callMethod('newMessage', {                                                            // 43\n        text: this.message,                                                                      // 44\n        type: 'text',                                                                            // 45\n        chatId: this.chatId                                                                      // 46\n      });                                                                                        // 43\n                                                                                                 //\n      delete this.message;                                                                       // 49\n    }                                                                                            // 50\n                                                                                                 //\n    return sendMessage;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.inputUp = function () {                                                     //\n    function inputUp() {                                                                         //\n      if (this.isIOS) {                                                                          // 53\n        this.keyboardHeight = 216;                                                               // 54\n      }                                                                                          // 55\n                                                                                                 //\n      this.scrollBottom(true);                                                                   // 57\n    }                                                                                            // 58\n                                                                                                 //\n    return inputUp;                                                                              //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.inputDown = function () {                                                   //\n    function inputDown() {                                                                       //\n      if (this.isIOS) {                                                                          // 61\n        this.keyboardHeight = 0;                                                                 // 62\n      }                                                                                          // 63\n                                                                                                 //\n      this.$ionicScrollDelegate.$getByHandle('chatScroll').resize();                             // 65\n    }                                                                                            // 66\n                                                                                                 //\n    return inputDown;                                                                            //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.closeKeyboard = function () {                                               //\n    function closeKeyboard() {                                                                   //\n      if (this.isCordova) {                                                                      // 69\n        cordova.plugins.Keyboard.close();                                                        // 70\n      }                                                                                          // 71\n    }                                                                                            // 72\n                                                                                                 //\n    return closeKeyboard;                                                                        //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.autoScroll = function () {                                                  //\n    function autoScroll() {                                                                      //\n      var _this3 = this;                                                                         // 74\n                                                                                                 //\n      var recentMessagesNum = this.messages.length;                                              // 75\n                                                                                                 //\n      this.autorun(function () {                                                                 // 77\n        var currMessagesNum = _this3.getCollectionReactively('messages').length;                 // 78\n        var animate = recentMessagesNum != currMessagesNum;                                      // 79\n        recentMessagesNum = currMessagesNum;                                                     // 80\n        _this3.scrollBottom(animate);                                                            // 81\n      });                                                                                        // 82\n    }                                                                                            // 83\n                                                                                                 //\n    return autoScroll;                                                                           //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.scrollBottom = function () {                                                //\n    function scrollBottom(animate) {                                                             //\n      var _this4 = this;                                                                         // 85\n                                                                                                 //\n      this.$timeout(function () {                                                                // 86\n        _this4.$ionicScrollDelegate.$getByHandle('chatScroll').scrollBottom(animate);            // 87\n      }, 300);                                                                                   // 88\n    }                                                                                            // 89\n                                                                                                 //\n    return scrollBottom;                                                                         //\n  }();                                                                                           //\n                                                                                                 //\n  ChatCtrl.prototype.handleError = function () {                                                 //\n    function handleError(err) {                                                                  //\n      if (err.error == 'cancel') return;                                                         // 92\n      this.$log.error('Profile save error ', err);                                               // 93\n                                                                                                 //\n      this.$ionicPopup.alert({                                                                   // 95\n        title: err.reason || 'Save failed',                                                      // 96\n        template: 'Please try again',                                                            // 97\n        okType: 'button-positive button-clear'                                                   // 98\n      });                                                                                        // 95\n    }                                                                                            // 100\n                                                                                                 //\n    return handleError;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  return ChatCtrl;                                                                               //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(ChatCtrl));                                             //\n                                                                                                 //\n                                                                                                 //\nChatCtrl.$name = 'ChatCtrl';                                                                     // 103\nChatCtrl.$inject = ['$stateParams', '$timeout', '$ionicScrollDelegate', '$ionicPopup', '$log'];  // 104\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"chats.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"angular-ecmascript/module-helpers\",\"../../../lib/collections\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/chats.controller.js                                                //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});var Chats;module.import('../../../lib/collections',{\"Chats\":function(v){Chats=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 //\nvar ChatsCtrl = function (_Controller) {                                                         //\n  _inherits(ChatsCtrl, _Controller);                                                             //\n                                                                                                 //\n  function ChatsCtrl() {                                                                         // 5\n    _classCallCheck(this, ChatsCtrl);                                                            // 5\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Controller.apply(this, arguments));            // 5\n                                                                                                 //\n    _this.helpers({                                                                              // 8\n      data: function () {                                                                        // 9\n        function data() {                                                                        // 8\n          return Chats.find();                                                                   // 10\n        }                                                                                        // 11\n                                                                                                 //\n        return data;                                                                             // 8\n      }()                                                                                        // 8\n    });                                                                                          // 8\n    return _this;                                                                                // 5\n  }                                                                                              // 13\n                                                                                                 //\n  ChatsCtrl.prototype.showNewChatModal = function () {                                           //\n    function showNewChatModal() {                                                                //\n      this.NewChat.showModal();                                                                  // 16\n    }                                                                                            // 17\n                                                                                                 //\n    return showNewChatModal;                                                                     //\n  }();                                                                                           //\n                                                                                                 //\n  ChatsCtrl.prototype.remove = function () {                                                     //\n    function remove(chat) {                                                                      //\n      this.callMethod('removeChat', chat._id);                                                   // 20\n    }                                                                                            // 21\n                                                                                                 //\n    return remove;                                                                               //\n  }();                                                                                           //\n                                                                                                 //\n  return ChatsCtrl;                                                                              //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(ChatsCtrl));                                            //\n                                                                                                 //\n                                                                                                 //\nChatsCtrl.$name = 'ChatsCtrl';                                                                   // 24\nChatsCtrl.$inject = ['NewChat'];                                                                 // 25\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"confirmation.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/underscore\",\"meteor/accounts-base\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/confirmation.controller.js                                         //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var Accounts;module.import('meteor/accounts-base',{\"Accounts\":function(v){Accounts=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar ConfirmationCtrl = function (_Controller) {                                                  //\n  _inherits(ConfirmationCtrl, _Controller);                                                      //\n                                                                                                 //\n  function ConfirmationCtrl() {                                                                  // 6\n    _classCallCheck(this, ConfirmationCtrl);                                                     // 6\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Controller.apply(this, arguments));            // 6\n                                                                                                 //\n    _this.phone = _this.$state.params.phone;                                                     // 9\n    return _this;                                                                                // 6\n  }                                                                                              // 10\n                                                                                                 //\n  ConfirmationCtrl.prototype.confirm = function () {                                             //\n    function confirm() {                                                                         //\n      var _this2 = this;                                                                         // 12\n                                                                                                 //\n      if (_.isEmpty(this.code)) return;                                                          // 13\n                                                                                                 //\n      Accounts.verifyPhone(this.phone, this.code, function (err) {                               // 15\n        if (err) return _this2.handleError(err);                                                 // 16\n        _this2.$state.go('profile');                                                             // 17\n      });                                                                                        // 18\n    }                                                                                            // 19\n                                                                                                 //\n    return confirm;                                                                              //\n  }();                                                                                           //\n                                                                                                 //\n  ConfirmationCtrl.prototype.handleError = function () {                                         //\n    function handleError(err) {                                                                  //\n      this.$log.error('Confirmation error ', err);                                               // 22\n                                                                                                 //\n      this.$ionicPopup.alert({                                                                   // 24\n        title: err.reason || 'Confirmation failed',                                              // 25\n        template: 'Please try again',                                                            // 26\n        okType: 'button-positive button-clear'                                                   // 27\n      });                                                                                        // 24\n    }                                                                                            // 29\n                                                                                                 //\n    return handleError;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  return ConfirmationCtrl;                                                                       //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(ConfirmationCtrl));                                     //\n                                                                                                 //\n                                                                                                 //\nConfirmationCtrl.$name = 'ConfirmationCtrl';                                                     // 32\nConfirmationCtrl.$inject = ['$state', '$ionicPopup', '$log'];                                    // 33\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"login.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/underscore\",\"meteor/accounts-base\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/login.controller.js                                                //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var Accounts;module.import('meteor/accounts-base',{\"Accounts\":function(v){Accounts=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar LoginCtrl = function (_Controller) {                                                         //\n  _inherits(LoginCtrl, _Controller);                                                             //\n                                                                                                 //\n  function LoginCtrl() {                                                                         //\n    _classCallCheck(this, LoginCtrl);                                                            //\n                                                                                                 //\n    return _possibleConstructorReturn(this, _Controller.apply(this, arguments));                 //\n  }                                                                                              //\n                                                                                                 //\n  LoginCtrl.prototype.login = function () {                                                      //\n    function login() {                                                                           //\n      var _this2 = this;                                                                         // 6\n                                                                                                 //\n      if (_.isEmpty(this.phone)) return;                                                         // 7\n                                                                                                 //\n      var confirmPopup = this.$ionicPopup.confirm({                                              // 9\n        title: 'Number confirmation',                                                            // 10\n        template: '<div>' + this.phone + '</div><div>Is your phone number above correct?</div>',\n        cssClass: 'text-center',                                                                 // 12\n        okText: 'Yes',                                                                           // 13\n        okType: 'button-positive button-clear',                                                  // 14\n        cancelText: 'edit',                                                                      // 15\n        cancelType: 'button-dark button-clear'                                                   // 16\n      });                                                                                        // 9\n                                                                                                 //\n      confirmPopup.then(function (res) {                                                         // 19\n        if (!res) return;                                                                        // 20\n                                                                                                 //\n        _this2.$ionicLoading.show({                                                              // 22\n          template: 'Sending verification code...'                                               // 23\n        });                                                                                      // 22\n                                                                                                 //\n        Accounts.requestPhoneVerification(_this2.phone, function (err) {                         // 26\n          _this2.$ionicLoading.hide();                                                           // 27\n          if (err) return _this2.handleError(err);                                               // 28\n          _this2.$state.go('confirmation', { phone: _this2.phone });                             // 29\n        });                                                                                      // 30\n      });                                                                                        // 31\n    }                                                                                            // 32\n                                                                                                 //\n    return login;                                                                                //\n  }();                                                                                           //\n                                                                                                 //\n  LoginCtrl.prototype.handleError = function () {                                                //\n    function handleError(err) {                                                                  //\n      this.$log.error('Login error ', err);                                                      // 35\n                                                                                                 //\n      this.$ionicPopup.alert({                                                                   // 37\n        title: err.reason || 'Login failed',                                                     // 38\n        template: 'Please try again',                                                            // 39\n        okType: 'button-positive button-clear'                                                   // 40\n      });                                                                                        // 37\n    }                                                                                            // 42\n                                                                                                 //\n    return handleError;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  return LoginCtrl;                                                                              //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(LoginCtrl));                                            //\n                                                                                                 //\n                                                                                                 //\nLoginCtrl.$name = 'LoginCtrl';                                                                   // 45\nLoginCtrl.$inject = ['$state', '$ionicLoading', '$ionicPopup', '$log'];                          // 46\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"new-chat.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/meteor\",\"angular-ecmascript/module-helpers\",\"../../../lib/collections\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/new-chat.controller.js                                             //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});var Chats;module.import('../../../lib/collections',{\"Chats\":function(v){Chats=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar NewChatCtrl = function (_Controller) {                                                       //\n  _inherits(NewChatCtrl, _Controller);                                                           //\n                                                                                                 //\n  function NewChatCtrl() {                                                                       // 6\n    _classCallCheck(this, NewChatCtrl);                                                          // 6\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Controller.apply(this, arguments));            // 6\n                                                                                                 //\n    _this.subscribe('users');                                                                    // 9\n                                                                                                 //\n    _this.helpers({                                                                              // 11\n      users: function () {                                                                       // 12\n        function users() {                                                                       // 11\n          return Meteor.users.find({ _id: { $ne: this.currentUserId } });                        // 13\n        }                                                                                        // 14\n                                                                                                 //\n        return users;                                                                            // 11\n      }()                                                                                        // 11\n    });                                                                                          // 11\n    return _this;                                                                                // 6\n  }                                                                                              // 16\n                                                                                                 //\n  NewChatCtrl.prototype.newChat = function () {                                                  //\n    function newChat(userId) {                                                                   //\n      var _this2 = this;                                                                         // 18\n                                                                                                 //\n      var chat = Chats.findOne({ userIds: { $all: [this.currentUserId, userId] } });             // 19\n                                                                                                 //\n      if (chat) {                                                                                // 21\n        this.hideNewChatModal();                                                                 // 22\n        return this.goToChat(chat._id);                                                          // 23\n      }                                                                                          // 24\n                                                                                                 //\n      this.callMethod('newChat', userId, function (err, chatId) {                                // 26\n        _this2.hideNewChatModal();                                                               // 27\n        if (err) return _this2.handleError(err);                                                 // 28\n        _this2.goToChat(chatId);                                                                 // 29\n      });                                                                                        // 30\n    }                                                                                            // 31\n                                                                                                 //\n    return newChat;                                                                              //\n  }();                                                                                           //\n                                                                                                 //\n  NewChatCtrl.prototype.hideNewChatModal = function () {                                         //\n    function hideNewChatModal() {                                                                //\n      this.NewChat.hideModal();                                                                  // 34\n    }                                                                                            // 35\n                                                                                                 //\n    return hideNewChatModal;                                                                     //\n  }();                                                                                           //\n                                                                                                 //\n  NewChatCtrl.prototype.goToChat = function () {                                                 //\n    function goToChat(chatId) {                                                                  //\n      this.$state.go('tab.chat', { chatId: chatId });                                            // 38\n    }                                                                                            // 39\n                                                                                                 //\n    return goToChat;                                                                             //\n  }();                                                                                           //\n                                                                                                 //\n  NewChatCtrl.prototype.handleError = function () {                                              //\n    function handleError(err) {                                                                  //\n      this.$log.error('New chat creation error ', err);                                          // 42\n                                                                                                 //\n      this.$ionicPopup.alert({                                                                   // 44\n        title: err.reason || 'New chat creation failed',                                         // 45\n        template: 'Please try again',                                                            // 46\n        okType: 'button-positive button-clear'                                                   // 47\n      });                                                                                        // 44\n    }                                                                                            // 49\n                                                                                                 //\n    return handleError;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  return NewChatCtrl;                                                                            //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(NewChatCtrl));                                          //\n                                                                                                 //\n                                                                                                 //\nNewChatCtrl.$name = 'NewChatCtrl';                                                               // 52\nNewChatCtrl.$inject = ['$state', 'NewChat', '$ionicPopup', '$log'];                              // 53\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"profile.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/underscore\",\"meteor/okland:camera-ui\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/profile.controller.js                                              //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var MeteorCameraUI;module.import('meteor/okland:camera-ui',{\"MeteorCameraUI\":function(v){MeteorCameraUI=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar ProfileCtrl = function (_Controller) {                                                       //\n  _inherits(ProfileCtrl, _Controller);                                                           //\n                                                                                                 //\n  function ProfileCtrl() {                                                                       // 6\n    _classCallCheck(this, ProfileCtrl);                                                          // 6\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Controller.apply(this, arguments));            // 6\n                                                                                                 //\n    var profile = _this.currentUser && _this.currentUser.profile;                                // 9\n    _this.name = profile ? profile.name : '';                                                    // 10\n    return _this;                                                                                // 6\n  }                                                                                              // 11\n                                                                                                 //\n  ProfileCtrl.prototype.updatePicture = function () {                                            //\n    function updatePicture() {                                                                   //\n      var _this2 = this;                                                                         // 13\n                                                                                                 //\n      MeteorCameraUI.getPicture({ width: 60, height: 60 }, function (err, data) {                // 14\n        if (err) return _this2.handleError(err);                                                 // 15\n                                                                                                 //\n        _this2.$ionicLoading.show({                                                              // 17\n          template: 'Updating picture...'                                                        // 18\n        });                                                                                      // 17\n                                                                                                 //\n        _this2.callMethod('updatePicture', data, function (err) {                                // 21\n          _this2.$ionicLoading.hide();                                                           // 22\n          _this2.handleError(err);                                                               // 23\n        });                                                                                      // 24\n      });                                                                                        // 25\n    }                                                                                            // 26\n                                                                                                 //\n    return updatePicture;                                                                        //\n  }();                                                                                           //\n                                                                                                 //\n  ProfileCtrl.prototype.updateName = function () {                                               //\n    function updateName() {                                                                      //\n      var _this3 = this;                                                                         // 28\n                                                                                                 //\n      if (_.isEmpty(this.name)) return;                                                          // 29\n                                                                                                 //\n      this.callMethod('updateName', this.name, function (err) {                                  // 31\n        if (err) return _this3.handleError(err);                                                 // 32\n        _this3.$state.go('tab.chats');                                                           // 33\n      });                                                                                        // 34\n    }                                                                                            // 35\n                                                                                                 //\n    return updateName;                                                                           //\n  }();                                                                                           //\n                                                                                                 //\n  ProfileCtrl.prototype.handleError = function () {                                              //\n    function handleError(err) {                                                                  //\n      if (err.error == 'cancel') return;                                                         // 38\n      this.$log.error('Profile save error ', err);                                               // 39\n                                                                                                 //\n      this.$ionicPopup.alert({                                                                   // 41\n        title: err.reason || 'Save failed',                                                      // 42\n        template: 'Please try again',                                                            // 43\n        okType: 'button-positive button-clear'                                                   // 44\n      });                                                                                        // 41\n    }                                                                                            // 46\n                                                                                                 //\n    return handleError;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  return ProfileCtrl;                                                                            //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(ProfileCtrl));                                          //\n                                                                                                 //\n                                                                                                 //\nProfileCtrl.$name = 'ProfileCtrl';                                                               // 49\nProfileCtrl.$inject = ['$state', '$ionicLoading', '$ionicPopup', '$log'];                        // 50\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"settings.controller.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/meteor\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/controllers/settings.controller.js                                             //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var Controller;module.import('angular-ecmascript/module-helpers',{\"Controller\":function(v){Controller=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 //\nvar SettingsCtrl = function (_Controller) {                                                      //\n  _inherits(SettingsCtrl, _Controller);                                                          //\n                                                                                                 //\n  function SettingsCtrl() {                                                                      //\n    _classCallCheck(this, SettingsCtrl);                                                         //\n                                                                                                 //\n    return _possibleConstructorReturn(this, _Controller.apply(this, arguments));                 //\n  }                                                                                              //\n                                                                                                 //\n  SettingsCtrl.prototype.logout = function () {                                                  //\n    function logout() {                                                                          //\n      var _this2 = this;                                                                         // 5\n                                                                                                 //\n      Meteor.logout(function (err) {                                                             // 6\n        if (err) return _this2.handleError(err);                                                 // 7\n        _this2.$state.go('login');                                                               // 8\n      });                                                                                        // 9\n    }                                                                                            // 10\n                                                                                                 //\n    return logout;                                                                               //\n  }();                                                                                           //\n                                                                                                 //\n  SettingsCtrl.prototype.handleError = function () {                                             //\n    function handleError(err) {                                                                  //\n      this.$log.error('Settings modification error', err);                                       // 13\n                                                                                                 //\n      this.$ionicPopup.alert({                                                                   // 15\n        title: err.reason || 'Settings modification failed',                                     // 16\n        template: 'Please try again',                                                            // 17\n        okType: 'button-positive button-clear'                                                   // 18\n      });                                                                                        // 15\n    }                                                                                            // 20\n                                                                                                 //\n    return handleError;                                                                          //\n  }();                                                                                           //\n                                                                                                 //\n  return SettingsCtrl;                                                                           //\n}(Controller);                                                                                   //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(SettingsCtrl));                                         //\n                                                                                                 //\n                                                                                                 //\nSettingsCtrl.$inject = ['$state', '$ionicPopup', '$log'];                                        // 23\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"directives\":{\"input.directive.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/directives/input.directive.js                                                  //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Directive;module.import('angular-ecmascript/module-helpers',{\"Directive\":function(v){Directive=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 //\nvar InputDirective = function (_Directive) {                                                     //\n  _inherits(InputDirective, _Directive);                                                         //\n                                                                                                 //\n  function InputDirective() {                                                                    // 4\n    _classCallCheck(this, InputDirective);                                                       // 4\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Directive.apply(this, arguments));             // 4\n                                                                                                 //\n    _this.restrict = 'E';                                                                        // 7\n                                                                                                 //\n    _this.scope = {                                                                              // 9\n      'returnClose': '=',                                                                        // 10\n      'onReturn': '&',                                                                           // 11\n      'onFocus': '&',                                                                            // 12\n      'onBlur': '&'                                                                              // 13\n    };                                                                                           // 9\n    return _this;                                                                                // 4\n  }                                                                                              // 15\n                                                                                                 //\n  InputDirective.prototype.link = function () {                                                  //\n    function link(scope, element) {                                                              //\n      var _this2 = this;                                                                         // 17\n                                                                                                 //\n      element.bind('focus', function (e) {                                                       // 18\n        if (!scope.onFocus) return;                                                              // 19\n                                                                                                 //\n        _this2.$timeout(function () {                                                            // 21\n          scope.onFocus();                                                                       // 22\n        });                                                                                      // 23\n      });                                                                                        // 24\n                                                                                                 //\n      element.bind('blur', function (e) {                                                        // 26\n        if (!scope.onBlur) return;                                                               // 27\n                                                                                                 //\n        _this2.$timeout(function () {                                                            // 29\n          scope.onBlur();                                                                        // 30\n        });                                                                                      // 31\n      });                                                                                        // 32\n                                                                                                 //\n      element.bind('keydown', function (e) {                                                     // 34\n        if (e.which != 13) return;                                                               // 35\n                                                                                                 //\n        if (scope.returnClose) {                                                                 // 37\n          element[0].blur();                                                                     // 38\n        }                                                                                        // 39\n                                                                                                 //\n        if (scope.onReturn) {                                                                    // 41\n          _this2.$timeout(function () {                                                          // 42\n            scope.onReturn();                                                                    // 43\n          });                                                                                    // 44\n        }                                                                                        // 45\n      });                                                                                        // 46\n    }                                                                                            // 47\n                                                                                                 //\n    return link;                                                                                 //\n  }();                                                                                           //\n                                                                                                 //\n  return InputDirective;                                                                         //\n}(Directive);                                                                                    //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(InputDirective));                                       //\n                                                                                                 //\n                                                                                                 //\nInputDirective.$name = 'input';                                                                  // 50\nInputDirective.$inject = ['$timeout'];                                                           // 51\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"filters\":{\"calendar.filter.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"moment\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/filters/calendar.filter.js                                                     //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Moment;module.import('moment',{\"default\":function(v){Moment=v}});var Filter;module.import('angular-ecmascript/module-helpers',{\"Filter\":function(v){Filter=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 //\nvar CalendarFilter = function (_Filter) {                                                        //\n  _inherits(CalendarFilter, _Filter);                                                            //\n                                                                                                 //\n  function CalendarFilter() {                                                                    //\n    _classCallCheck(this, CalendarFilter);                                                       //\n                                                                                                 //\n    return _possibleConstructorReturn(this, _Filter.apply(this, arguments));                     //\n  }                                                                                              //\n                                                                                                 //\n  CalendarFilter.prototype.filter = function () {                                                //\n    function filter(time) {                                                                      //\n      if (!time) return;                                                                         // 6\n                                                                                                 //\n      return Moment(time).calendar(null, {                                                       // 8\n        lastDay: '[Yesterday]',                                                                  // 9\n        sameDay: 'LT',                                                                           // 10\n        lastWeek: 'dddd',                                                                        // 11\n        sameElse: 'DD/MM/YY'                                                                     // 12\n      });                                                                                        // 8\n    }                                                                                            // 14\n                                                                                                 //\n    return filter;                                                                               //\n  }();                                                                                           //\n                                                                                                 //\n  return CalendarFilter;                                                                         //\n}(Filter);                                                                                       //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(CalendarFilter));                                       //\n                                                                                                 //\n                                                                                                 //\nCalendarFilter.$name = 'calendar';                                                               // 17\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"chat-name.filter.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/underscore\",\"meteor/meteor\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/filters/chat-name.filter.js                                                    //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var Filter;module.import('angular-ecmascript/module-helpers',{\"Filter\":function(v){Filter=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar ChatNameFilter = function (_Filter) {                                                        //\n  _inherits(ChatNameFilter, _Filter);                                                            //\n                                                                                                 //\n  function ChatNameFilter() {                                                                    //\n    _classCallCheck(this, ChatNameFilter);                                                       //\n                                                                                                 //\n    return _possibleConstructorReturn(this, _Filter.apply(this, arguments));                     //\n  }                                                                                              //\n                                                                                                 //\n  ChatNameFilter.prototype.filter = function () {                                                //\n    function filter(chat) {                                                                      //\n      if (!chat) return;                                                                         // 7\n                                                                                                 //\n      var otherId = _.without(chat.userIds, Meteor.userId())[0];                                 // 9\n      var otherUser = Meteor.users.findOne(otherId);                                             // 10\n      var hasName = otherUser && otherUser.profile && otherUser.profile.name;                    // 11\n                                                                                                 //\n      return hasName ? otherUser.profile.name : chat.name || 'NO NAME';                          // 13\n    }                                                                                            // 14\n                                                                                                 //\n    return filter;                                                                               //\n  }();                                                                                           //\n                                                                                                 //\n  return ChatNameFilter;                                                                         //\n}(Filter);                                                                                       //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(ChatNameFilter));                                       //\n                                                                                                 //\n                                                                                                 //\nChatNameFilter.$name = 'chatName';                                                               // 17\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"chat-picture.filter.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/underscore\",\"meteor/meteor\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/filters/chat-picture.filter.js                                                 //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var Filter;module.import('angular-ecmascript/module-helpers',{\"Filter\":function(v){Filter=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar ChatPictureFilter = function (_Filter) {                                                     //\n  _inherits(ChatPictureFilter, _Filter);                                                         //\n                                                                                                 //\n  function ChatPictureFilter() {                                                                 //\n    _classCallCheck(this, ChatPictureFilter);                                                    //\n                                                                                                 //\n    return _possibleConstructorReturn(this, _Filter.apply(this, arguments));                     //\n  }                                                                                              //\n                                                                                                 //\n  ChatPictureFilter.prototype.filter = function () {                                             //\n    function filter(chat) {                                                                      //\n      if (!chat) return;                                                                         // 7\n                                                                                                 //\n      var otherId = _.without(chat.userIds, Meteor.userId())[0];                                 // 9\n      var otherUser = Meteor.users.findOne(otherId);                                             // 10\n      var hasPicture = otherUser && otherUser.profile && otherUser.profile.picture;              // 11\n                                                                                                 //\n      return hasPicture ? otherUser.profile.picture : chat.picture || '/user-default.svg';       // 13\n    }                                                                                            // 14\n                                                                                                 //\n    return filter;                                                                               //\n  }();                                                                                           //\n                                                                                                 //\n  return ChatPictureFilter;                                                                      //\n}(Filter);                                                                                       //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(ChatPictureFilter));                                    //\n                                                                                                 //\n                                                                                                 //\nChatPictureFilter.$name = 'chatPicture';                                                         // 17\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"services\":{\"new-chat.service.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/services/new-chat.service.js                                                   //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var Service;module.import('angular-ecmascript/module-helpers',{\"Service\":function(v){Service=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 //\nvar NewChatService = function (_Service) {                                                       //\n  _inherits(NewChatService, _Service);                                                           //\n                                                                                                 //\n  function NewChatService() {                                                                    // 4\n    _classCallCheck(this, NewChatService);                                                       // 4\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Service.apply(this, arguments));               // 4\n                                                                                                 //\n    _this.templateUrl = 'client/templates/new-chat.html';                                        // 7\n    return _this;                                                                                // 4\n  }                                                                                              // 8\n                                                                                                 //\n  NewChatService.prototype.showModal = function () {                                             //\n    function showModal() {                                                                       //\n      var _this2 = this;                                                                         // 10\n                                                                                                 //\n      this.scope = this.$rootScope.$new();                                                       // 11\n                                                                                                 //\n      this.$ionicModal.fromTemplateUrl(this.templateUrl, {                                       // 13\n        scope: this.scope                                                                        // 14\n      }).then(function (modal) {                                                                 // 13\n        _this2.modal = modal;                                                                    // 17\n        _this2.modal.show();                                                                     // 18\n      });                                                                                        // 19\n    }                                                                                            // 20\n                                                                                                 //\n    return showModal;                                                                            //\n  }();                                                                                           //\n                                                                                                 //\n  NewChatService.prototype.hideModal = function () {                                             //\n    function hideModal() {                                                                       //\n      this.scope.$destroy();                                                                     // 23\n      this.modal.remove();                                                                       // 24\n    }                                                                                            // 25\n                                                                                                 //\n    return hideModal;                                                                            //\n  }();                                                                                           //\n                                                                                                 //\n  return NewChatService;                                                                         //\n}(Service);                                                                                      //\n                                                                                                 //\nmodule.export(\"default\",exports.default=(NewChatService));                                       //\n                                                                                                 //\n                                                                                                 //\nNewChatService.$name = 'NewChat';                                                                // 28\nNewChatService.$inject = ['$rootScope', '$ionicModal'];                                          // 29\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"routes.js\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"meteor/underscore\",\"meteor/meteor\",\"angular-ecmascript/module-helpers\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/scripts/routes.js                                                                      //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar _classCallCheck;module.import('babel-runtime/helpers/classCallCheck',{\"default\":function(v){_classCallCheck=v}});var _possibleConstructorReturn;module.import('babel-runtime/helpers/possibleConstructorReturn',{\"default\":function(v){_possibleConstructorReturn=v}});var _inherits;module.import('babel-runtime/helpers/inherits',{\"default\":function(v){_inherits=v}});var _;module.import('meteor/underscore',{\"_\":function(v){_=v}});var Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var Config,Runner;module.import('angular-ecmascript/module-helpers',{\"Config\":function(v){Config=v},\"Runner\":function(v){Runner=v}});\n                                                                                                 //\n                                                                                                 //\n                                                                                                 // 1\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nvar RoutesConfig = function (_Config) {                                                          //\n  _inherits(RoutesConfig, _Config);                                                              //\n                                                                                                 //\n  function RoutesConfig() {                                                                      // 6\n    _classCallCheck(this, RoutesConfig);                                                         // 6\n                                                                                                 //\n    var _this = _possibleConstructorReturn(this, _Config.apply(this, arguments));                // 6\n                                                                                                 //\n    _this.isAuthorized = ['$auth', _this.isAuthorized.bind(_this)];                              // 9\n    return _this;                                                                                // 6\n  }                                                                                              // 10\n                                                                                                 //\n  RoutesConfig.prototype.configure = function () {                                               //\n    function configure() {                                                                       //\n      this.$stateProvider.state('tab', {                                                         // 13\n        url: '/tab',                                                                             // 15\n        abstract: true,                                                                          // 16\n        templateUrl: 'client/templates/tabs.html',                                               // 17\n        resolve: {                                                                               // 18\n          user: this.isAuthorized,                                                               // 19\n          chats: function () {                                                                   // 20\n            function chats() {                                                                   // 18\n              return Meteor.subscribe('chats');                                                  // 21\n            }                                                                                    // 22\n                                                                                                 //\n            return chats;                                                                        // 18\n          }()                                                                                    // 18\n        }                                                                                        // 18\n      }).state('tab.chats', {                                                                    // 14\n        url: '/chats',                                                                           // 26\n        views: {                                                                                 // 27\n          'tab-chats': {                                                                         // 28\n            templateUrl: 'client/templates/chats.html',                                          // 29\n            controller: 'ChatsCtrl as chats'                                                     // 30\n          }                                                                                      // 28\n        }                                                                                        // 27\n      }).state('tab.chat', {                                                                     // 25\n        url: '/chats/:chatId',                                                                   // 35\n        views: {                                                                                 // 36\n          'tab-chats': {                                                                         // 37\n            templateUrl: 'client/templates/chat.html',                                           // 38\n            controller: 'ChatCtrl as chat'                                                       // 39\n          }                                                                                      // 37\n        }                                                                                        // 36\n      }).state('login', {                                                                        // 34\n        url: '/login',                                                                           // 44\n        templateUrl: 'client/templates/login.html',                                              // 45\n        controller: 'LoginCtrl as logger'                                                        // 46\n      }).state('confirmation', {                                                                 // 43\n        url: '/confirmation/:phone',                                                             // 49\n        templateUrl: 'client/templates/confirmation.html',                                       // 50\n        controller: 'ConfirmationCtrl as confirmation'                                           // 51\n      }).state('profile', {                                                                      // 48\n        url: '/profile',                                                                         // 54\n        templateUrl: 'client/templates/profile.html',                                            // 55\n        controller: 'ProfileCtrl as profile',                                                    // 56\n        resolve: {                                                                               // 57\n          user: this.isAuthorized                                                                // 58\n        }                                                                                        // 57\n      }).state('tab.settings', {                                                                 // 53\n        url: '/settings',                                                                        // 62\n        views: {                                                                                 // 63\n          'tab-settings': {                                                                      // 64\n            templateUrl: 'client/templates/settings.html',                                       // 65\n            controller: 'SettingsCtrl as settings'                                               // 66\n          }                                                                                      // 64\n        }                                                                                        // 63\n      });                                                                                        // 61\n                                                                                                 //\n      this.$urlRouterProvider.otherwise('tab/chats');                                            // 71\n    }                                                                                            // 72\n                                                                                                 //\n    return configure;                                                                            //\n  }();                                                                                           //\n                                                                                                 //\n  RoutesConfig.prototype.isAuthorized = function () {                                            //\n    function isAuthorized($auth) {                                                               //\n      return $auth.awaitUser();                                                                  // 75\n    }                                                                                            // 76\n                                                                                                 //\n    return isAuthorized;                                                                         //\n  }();                                                                                           //\n                                                                                                 //\n  return RoutesConfig;                                                                           //\n}(Config);                                                                                       //\n                                                                                                 //\nRoutesConfig.$inject = ['$stateProvider', '$urlRouterProvider'];                                 // 79\n                                                                                                 //\nvar RoutesRunner = function (_Runner) {                                                          //\n  _inherits(RoutesRunner, _Runner);                                                              //\n                                                                                                 //\n  function RoutesRunner() {                                                                      //\n    _classCallCheck(this, RoutesRunner);                                                         //\n                                                                                                 //\n    return _possibleConstructorReturn(this, _Runner.apply(this, arguments));                     //\n  }                                                                                              //\n                                                                                                 //\n  RoutesRunner.prototype.run = function () {                                                     //\n    function run() {                                                                             //\n      var _this3 = this;                                                                         // 82\n                                                                                                 //\n      this.$rootScope.$on('$stateChangeError', function () {                                     // 83\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {   // 83\n          args[_key] = arguments[_key];                                                          // 83\n        }                                                                                        // 83\n                                                                                                 //\n        var err = _.last(args);                                                                  // 84\n                                                                                                 //\n        if (err === 'AUTH_REQUIRED') {                                                           // 86\n          _this3.$state.go('login');                                                             // 87\n        }                                                                                        // 88\n      });                                                                                        // 89\n    }                                                                                            // 90\n                                                                                                 //\n    return run;                                                                                  //\n  }();                                                                                           //\n                                                                                                 //\n  return RoutesRunner;                                                                           //\n}(Runner);                                                                                       //\n                                                                                                 //\nRoutesRunner.$inject = ['$rootScope', '$state'];                                                 // 93\n                                                                                                 //\nmodule.export(\"default\",exports.default=([RoutesConfig, RoutesRunner]));                         // 95\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"templates\":{\"chat.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/chat.html                                                                    //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/chat.html\";                                           // 4\n      var template = \"<ion-view title=\\\"{{ chat.data | chatName }}\\\"> <ion-nav-buttons side=\\\"right\\\"> <button class=\\\"button button-clear\\\"><img class=\\\"header-picture\\\" ng-src=\\\"{{ chat.data | chatPicture }}\\\"></button> </ion-nav-buttons> <ion-content class=\\\"chat\\\" delegate-handle=\\\"chatScroll\\\"> <div class=\\\"message-list\\\"> <div ng-repeat=\\\"message in chat.messages\\\" class=\\\"message-wrapper\\\"> <div class=\\\"message\\\" ng-class=\\\"message.userId === $root.currentUser._id ? 'message-mine' : 'message-other'\\\"> <ng-switch on=\\\"message.type\\\"> <div ng-switch-when=\\\"text\\\" class=\\\"text\\\">{{ message.text }}</div> <div ng-switch-when=\\\"picture\\\" class=\\\"picture\\\"> <img ng-src=\\\"{{ message.picture }}\\\"> </div> </ng-switch> <span class=\\\"message-timestamp\\\">{{ message.timestamp | amDateFormat: 'HH:MM' }}</span> </div> </div> </div> </ion-content> <ion-footer-bar keyboard-attach class=\\\"bar-stable footer-chat item-input-inset\\\"> <button class=\\\"button button-clear button-icon button-positive icon ion-ios-upload-outline\\\"></button> <label class=\\\"item-input-wrapper\\\"> <input ng-model=\\\"chat.message\\\" dir=\\\"auto\\\" type=\\\"text\\\" on-return=\\\"chat.sendMessage(); chat.closeKeyboard()\\\" on-focus=\\\"chat.inputUp()\\\" on-blur=\\\"chat.inputDown()\\\"> </label> <span ng-if=\\\"chat.message.length > 0\\\"> <button ng-click=\\\"chat.sendMessage()\\\" class=\\\"button button-clear button-positive\\\">Send</button> </span> <span ng-if=\\\"!chat.message || chat.message.length === 0\\\"> <button ng-click=\\\"chat.sendPicture()\\\" class=\\\"button button-clear button-icon button-positive icon ion-ios-camera-outline\\\"></button> <i class=\\\"buttons-seperator icon ion-android-more-vertical\\\"></i> <button class=\\\"button button-clear button-icon button-positive icon ion-ios-mic-outline\\\"></button> </span> </ion-footer-bar> </ion-view>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"chats.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/chats.html                                                                   //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/chats.html\";                                          // 4\n      var template = \"<ion-view view-title=\\\"Chats\\\"> <ion-nav-buttons side=\\\"right\\\"> <button ng-click=\\\"chats.showNewChatModal()\\\" class=\\\"button button-clear button-positive button-icon ion-ios-compose-outline\\\"></button> </ion-nav-buttons> <ion-content> <ion-list> <ion-item ng-repeat=\\\"chat in chats.data | orderBy:'-lastMessage.timestamp'\\\" class=\\\"item-chat item-remove-animate item-avatar item-icon-right\\\" type=\\\"item-text-wrap\\\" href=\\\"#/tab/chats/{{ chat._id }}\\\"> <img ng-src=\\\"{{ chat | chatPicture }}\\\"> <h2>{{ chat | chatName }}</h2> <ng-switch on=\\\"chat.lastMessage.type\\\"> <p ng-switch-when=\\\"text\\\">{{ chat.lastMessage.text }}</p> <p ng-switch-when=\\\"picture\\\">image</p> </ng-switch> <span class=\\\"last-message-timestamp\\\">{{ chat.lastMessage.timestamp | calendar }}</span> <i class=\\\"icon ion-chevron-right icon-accessory\\\"></i> <ion-option-button class=\\\"button-assertive\\\" ng-click=\\\"chats.remove(chat)\\\"> Delete </ion-option-button> </ion-item> </ion-list> </ion-content> </ion-view>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"confirmation.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/confirmation.html                                                            //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/confirmation.html\";                                   // 4\n      var template = \"<ion-view title=\\\"{{ confirmation.phone }}\\\"> <ion-nav-buttons side=\\\"right\\\"> <button ng-click=\\\"confirmation.confirm()\\\" ng-disabled=\\\"!confirmation.code || confirmation.code.length === 0\\\" class=\\\"button button-clear button-positive\\\">Done</button> </ion-nav-buttons> <ion-content> <div class=\\\"text-center padding\\\"> We have sent you an SMS with a code to the number above </div> <div class=\\\"text-center padding\\\"> To complete your phone number verification WhatsApp, please enter the 4-digit activation code. </div> <div class=\\\"list padding-top\\\"> <label class=\\\"item item-input\\\"> <input ng-model=\\\"confirmation.code\\\" on-return=\\\"confirmation.confirm()\\\" type=\\\"text\\\" placeholder=\\\"Code\\\"> </label> </div> </ion-content> </ion-view>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"login.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/login.html                                                                   //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/login.html\";                                          // 4\n      var template = \"<ion-view title=\\\"Your phone number\\\"> <ion-nav-buttons side=\\\"right\\\"> <button ng-click=\\\"logger.login()\\\" ng-disabled=\\\"!logger.phone || logger.phone.length === 0\\\" class=\\\"button button-clear button-positive\\\">Done</button> </ion-nav-buttons> <ion-content class=\\\"login\\\"> <div class=\\\"text-center instructions\\\"> Please confirm your country code and enter your phone number </div> <div class=\\\"list\\\"> <label class=\\\"item item-input\\\"> <input ng-model=\\\"logger.phone\\\" on-return=\\\"logger.login()\\\" type=\\\"text\\\" placeholder=\\\"Your phone number\\\"> </label> </div> </ion-content> </ion-view>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"new-chat.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/new-chat.html                                                                //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/new-chat.html\";                                       // 4\n      var template = \"<ion-modal-view ng-controller=\\\"NewChatCtrl as chat\\\"> <ion-header-bar> <h1 class=\\\"title\\\">New Chat</h1> <div class=\\\"buttons\\\"> <button class=\\\"button button-clear button-positive\\\" ng-click=\\\"chat.hideNewChatModal()\\\">Cancel</button> </div> </ion-header-bar> <ion-content> <div class=\\\"list\\\"> <a ng-repeat=\\\"user in chat.users\\\" ng-click=\\\"chat.newChat(user._id)\\\" class=\\\"item\\\"> <h2>{{ user.profile.name }}</h2> <p> Hey there! I am using meteor-Whatsapp with meteor. </p> </a> </div> </ion-content> </ion-modal-view>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"profile.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/profile.html                                                                 //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/profile.html\";                                        // 4\n      var template = \"<ion-view title=\\\"Profile\\\"> <ion-nav-buttons side=\\\"right\\\"> <button ng-click=\\\"profile.updateName()\\\" ng-disabled=\\\"!profile.name || profile.name.length === 0\\\" class=\\\"button button-clear button-positive\\\">Done</button> </ion-nav-buttons> <ion-content class=\\\"profile\\\"> <a class=\\\"profile-picture positive\\\" ng-click=\\\"profile.updatePicture()\\\"> <div ng-if=\\\"profile.currentUser.profile.picture\\\"> <img ng-src=\\\"{{ profile.currentUser.profile.picture }}\\\" alt=\\\"profile picture\\\"> edit </div> <div ng-if=\\\"!profile.currentUser.profile.picture\\\" class=\\\"upload-placehoder\\\"> Add photo </div> </a> <div class=\\\"instructions\\\"> Enter your name and add an optional profile picture </div> <div class=\\\"list profile-name\\\"> <label class=\\\"item item-input\\\"> <input ng-model=\\\"profile.name\\\" on-return=\\\"profile.updateName()\\\" type=\\\"text\\\" placeholder=\\\"Your name\\\"> </label> </div> </ion-content> </ion-view>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"settings.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/settings.html                                                                //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/settings.html\";                                       // 4\n      var template = \"<ion-view view-title=\\\"Settings\\\"> <ion-content> <div class=\\\"padding text-center\\\"> <button ng-click=\\\"settings.logout()\\\" class=\\\"button button-clear button-assertive\\\">Logout</button> </div> <ion-list> <ion-item href=\\\"#/profile\\\" class=\\\"item-icon-right\\\"> Profile <i class=\\\"icon ion-chevron-right icon-accessory\\\"></i> </ion-item> </ion-list> </ion-content> </ion-view> \";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"tabs.html\":function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/templates/tabs.html                                                                    //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n      if (Meteor.isServer) return;                                                               // 2\n                                                                                                 // 3\n      var templateUrl = \"/client/templates/tabs.html\";                                           // 4\n      var template = \"<ion-tabs class=\\\"tabs-stable tabs-icon-top tabs-color-positive\\\" ng-cloak> <ion-tab title=\\\"Favorites\\\" icon-on=\\\"ion-ios-star\\\" icon-off=\\\"ion-ios-star-outline\\\" href=\\\"#/tab/favorites\\\"> <ion-nav-view name=\\\"tab-favorites\\\"></ion-nav-view> </ion-tab> <ion-tab title=\\\"Recents\\\" icon-on=\\\"ion-ios-clock\\\" icon-off=\\\"ion-ios-clock-outline\\\" href=\\\"#/tab/recents\\\"> <ion-nav-view name=\\\"tab-recents\\\"></ion-nav-view> </ion-tab> <ion-tab title=\\\"Contacts\\\" icon-on=\\\"ion-ios-person\\\" icon-off=\\\"ion-ios-person-outline\\\" href=\\\"#/tab/contacts\\\"> <ion-nav-view name=\\\"tab-contacts\\\"></ion-nav-view> </ion-tab> <ion-tab title=\\\"Chats\\\" icon-on=\\\"ion-ios-chatbubble\\\" icon-off=\\\"ion-ios-chatbubble-outline\\\" href=\\\"#/tab/chats\\\"> <ion-nav-view name=\\\"tab-chats\\\"></ion-nav-view> </ion-tab> <ion-tab title=\\\"Settings\\\" icon-on=\\\"ion-ios-cog\\\" icon-off=\\\"ion-ios-cog-outline\\\" href=\\\"#/tab/settings\\\"> <ion-nav-view name=\\\"tab-settings\\\"></ion-nav-view> </ion-tab> </ion-tabs>\";\n                                                                                                 // 6\n      angular.module('angular-templates')                                                        // 7\n        .run(['$templateCache', function($templateCache) {                                       // 8\n          $templateCache.put(templateUrl, template);                                             // 9\n        }]);                                                                                     // 10\n                                                                                                 // 11\n      module.exports = {};                                                                       // 12\n      module.exports.__esModule = true;                                                          // 13\n      module.exports.default = templateUrl;                                                      // 14\n                                                                                                 // 15\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"index.html.js\":function(){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// client/index.html.js                                                                          //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\n                                                                                                 // 1\n            Meteor.startup(function() {                                                          // 2\n              var attrs = {};                                                                    // 3\n              for (var prop in attrs) {                                                          // 4\n                document.body.setAttribute(prop, attrs[prop]);                                   // 5\n              }                                                                                  // 6\n            });                                                                                  // 7\n                                                                                                 // 8\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"lib\":{\"collections.js\":[\"meteor/mongo\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// lib/collections.js                                                                            //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nmodule.export({Chats:function(){return Chats},Messages:function(){return Messages}});var Mongo;module.import('meteor/mongo',{\"Mongo\":function(v){Mongo=v}});\n                                                                                                 //\nvar Chats = new Mongo.Collection('chats');                                                       // 3\nvar Messages = new Mongo.Collection('messages');                                                 // 4\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"methods.js\":[\"meteor/meteor\",\"meteor/check\",\"../lib/collections\",function(require,exports,module){\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                               //\n// lib/methods.js                                                                                //\n//                                                                                               //\n///////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                 //\nvar Meteor;module.import('meteor/meteor',{\"Meteor\":function(v){Meteor=v}});var check;module.import('meteor/check',{\"check\":function(v){check=v}});var Chats,Messages;module.import('../lib/collections',{\"Chats\":function(v){Chats=v},\"Messages\":function(v){Messages=v}});\n                                                                                                 // 2\n                                                                                                 // 3\n                                                                                                 //\nMeteor.methods({                                                                                 // 5\n  newMessage: function () {                                                                      // 6\n    function newMessage(message) {                                                               // 5\n      if (!this.userId) {                                                                        // 7\n        throw new Meteor.Error('not-logged-in', 'Must be logged in to send message.');           // 8\n      }                                                                                          // 10\n                                                                                                 //\n      check(message, Match.OneOf({                                                               // 12\n        text: String,                                                                            // 14\n        type: String,                                                                            // 15\n        chatId: String                                                                           // 16\n      }, {                                                                                       // 13\n        picture: String,                                                                         // 19\n        type: String,                                                                            // 20\n        chatId: String                                                                           // 21\n      }));                                                                                       // 18\n                                                                                                 //\n      message.timestamp = new Date();                                                            // 25\n      message.userId = this.userId;                                                              // 26\n                                                                                                 //\n      var messageId = Messages.insert(message);                                                  // 28\n      Chats.update(message.chatId, { $set: { lastMessage: message } });                          // 29\n                                                                                                 //\n      return messageId;                                                                          // 31\n    }                                                                                            // 32\n                                                                                                 //\n    return newMessage;                                                                           // 5\n  }(),                                                                                           // 5\n  updateName: function () {                                                                      // 33\n    function updateName(name) {                                                                  // 5\n      if (!this.userId) {                                                                        // 34\n        throw new Meteor.Error('not-logged-in', 'Must be logged in to update his name.');        // 35\n      }                                                                                          // 37\n                                                                                                 //\n      check(name, String);                                                                       // 39\n                                                                                                 //\n      if (name.length === 0) {                                                                   // 41\n        throw Meteor.Error('name-required', 'Must provide a user name');                         // 42\n      }                                                                                          // 43\n                                                                                                 //\n      return Meteor.users.update(this.userId, { $set: { 'profile.name': name } });               // 45\n    }                                                                                            // 46\n                                                                                                 //\n    return updateName;                                                                           // 5\n  }(),                                                                                           // 5\n  newChat: function () {                                                                         // 47\n    function newChat(otherId) {                                                                  // 5\n      if (!this.userId) {                                                                        // 48\n        throw new Meteor.Error('not-logged-in', 'Must be logged to create a chat.');             // 49\n      }                                                                                          // 51\n                                                                                                 //\n      check(otherId, String);                                                                    // 53\n      var otherUser = Meteor.users.findOne(otherId);                                             // 54\n                                                                                                 //\n      if (!otherUser) {                                                                          // 56\n        throw new Meteor.Error('user-not-exists', 'Chat\\'s user not exists');                    // 57\n      }                                                                                          // 59\n                                                                                                 //\n      var chat = {                                                                               // 61\n        userIds: [this.userId, otherId],                                                         // 62\n        createdAt: new Date()                                                                    // 63\n      };                                                                                         // 61\n                                                                                                 //\n      var chatId = Chats.insert(chat);                                                           // 66\n                                                                                                 //\n      return chatId;                                                                             // 68\n    }                                                                                            // 69\n                                                                                                 //\n    return newChat;                                                                              // 5\n  }(),                                                                                           // 5\n  removeChat: function () {                                                                      // 70\n    function removeChat(chatId) {                                                                // 5\n      if (!this.userId) {                                                                        // 71\n        throw new Meteor.Error('not-logged-in', 'Must be logged to create a chat.');             // 72\n      }                                                                                          // 74\n                                                                                                 //\n      check(chatId, String);                                                                     // 76\n                                                                                                 //\n      var chat = Chats.findOne(chatId);                                                          // 78\n                                                                                                 //\n      if (!chat || !_.include(chat.userIds, this.userId)) {                                      // 80\n        throw new Meteor.Error('chat-not-exists', 'Chat not exists');                            // 81\n      }                                                                                          // 83\n                                                                                                 //\n      Messages.remove({ chatId: chatId });                                                       // 85\n                                                                                                 //\n      return Chats.remove({ _id: chatId });                                                      // 87\n    }                                                                                            // 88\n                                                                                                 //\n    return removeChat;                                                                           // 5\n  }(),                                                                                           // 5\n  updatePicture: function () {                                                                   // 89\n    function updatePicture(data) {                                                               // 5\n      if (!this.userId) {                                                                        // 90\n        throw new Meteor.Error('not-logged-in', 'Must be logged in to update his picture.');     // 91\n      }                                                                                          // 93\n                                                                                                 //\n      check(data, String);                                                                       // 95\n                                                                                                 //\n      return Meteor.users.update(this.userId, { $set: { 'profile.picture': data } });            // 97\n    }                                                                                            // 98\n                                                                                                 //\n    return updatePicture;                                                                        // 5\n  }()                                                                                            // 5\n});                                                                                              // 5\n///////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]}},{\"extensions\":[\".js\",\".json\",\".html\"]});\nrequire(\"./client/scripts/lib/app.js\");\nrequire(\"./lib/collections.js\");\nrequire(\"./lib/methods.js\");\nrequire(\"./client/scripts/controllers/chat.controller.js\");\nrequire(\"./client/scripts/controllers/chats.controller.js\");\nrequire(\"./client/scripts/controllers/confirmation.controller.js\");\nrequire(\"./client/scripts/controllers/login.controller.js\");\nrequire(\"./client/scripts/controllers/new-chat.controller.js\");\nrequire(\"./client/scripts/controllers/profile.controller.js\");\nrequire(\"./client/scripts/controllers/settings.controller.js\");\nrequire(\"./client/scripts/directives/input.directive.js\");\nrequire(\"./client/scripts/filters/calendar.filter.js\");\nrequire(\"./client/scripts/filters/chat-name.filter.js\");\nrequire(\"./client/scripts/filters/chat-picture.filter.js\");\nrequire(\"./client/scripts/services/new-chat.service.js\");\nrequire(\"./client/scripts/routes.js\");\nrequire(\"./client/templates/chat.html\");\nrequire(\"./client/templates/chats.html\");\nrequire(\"./client/templates/confirmation.html\");\nrequire(\"./client/templates/login.html\");\nrequire(\"./client/templates/new-chat.html\");\nrequire(\"./client/templates/profile.html\");\nrequire(\"./client/templates/settings.html\");\nrequire(\"./client/templates/tabs.html\");\nrequire(\"./client/index.html.js\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["/client/scripts/lib/app.js","/client/scripts/controllers/chat.controller.js","/client/scripts/controllers/chats.controller.js","/client/scripts/controllers/confirmation.controller.js","/client/scripts/controllers/login.controller.js","/client/scripts/controllers/new-chat.controller.js","/client/scripts/controllers/profile.controller.js","/client/scripts/controllers/settings.controller.js","/client/scripts/directives/input.directive.js","/client/scripts/filters/calendar.filter.js","/client/scripts/filters/chat-name.filter.js","/client/scripts/filters/chat-picture.filter.js","/client/scripts/services/new-chat.service.js","/client/scripts/routes.js","/lib/collections.js","/lib/methods.js"],"names":["Angular","Loader","Meteor","ChatsCtrl","ChatCtrl","ConfirmationCtrl","LoginCtrl","NewChatCtrl","ProfileCtrl","SettingsCtrl","InputDirective","CalendarFilter","ChatNameFilter","ChatPictureFilter","NewChatService","Routes","App","module","load","isCordova","element","document","on","onReady","ready","bootstrap","Ionic","_","MeteorCameraUI","Controller","Chats","Messages","arguments","chatId","$stateParams","isIOS","Platform","isWebView","helpers","messages","find","data","findOne","autoScroll","sendPicture","getPicture","err","handleError","callMethod","picture","type","sendMessage","isEmpty","message","text","inputUp","keyboardHeight","scrollBottom","inputDown","$ionicScrollDelegate","$getByHandle","resize","closeKeyboard","cordova","plugins","Keyboard","close","recentMessagesNum","length","autorun","currMessagesNum","getCollectionReactively","animate","$timeout","error","$log","$ionicPopup","alert","title","reason","template","okType","$name","$inject","showNewChatModal","NewChat","showModal","remove","chat","_id","Accounts","phone","$state","params","confirm","code","verifyPhone","go","login","confirmPopup","cssClass","okText","cancelText","cancelType","then","res","$ionicLoading","show","requestPhoneVerification","hide","subscribe","users","$ne","currentUserId","newChat","userId","userIds","$all","hideNewChatModal","goToChat","hideModal","profile","currentUser","name","updatePicture","width","height","updateName","logout","Directive","restrict","scope","link","bind","e","onFocus","onBlur","which","returnClose","blur","onReturn","Moment","Filter","filter","time","calendar","lastDay","sameDay","lastWeek","sameElse","otherId","without","otherUser","hasName","hasPicture","Service","templateUrl","$rootScope","$new","$ionicModal","fromTemplateUrl","modal","$destroy","Config","Runner","RoutesConfig","isAuthorized","configure","$stateProvider","state","url","abstract","resolve","user","chats","views","controller","$urlRouterProvider","otherwise","$auth","awaitUser","RoutesRunner","run","$on","args","last","Mongo","Collection","check","methods","newMessage","Error","Match","OneOf","String","timestamp","Date","messageId","insert","update","$set","lastMessage","createdAt","removeChat","include"],"mappings":"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","file":"/app.js","sourcesContent":["// Libs\nimport 'angular-animate';\nimport 'angular-meteor';\nimport 'angular-meteor-auth';\nimport 'angular-moment';\nimport 'angular-sanitize';\nimport 'angular-ui-router';\nimport 'ionic-scripts';\nimport Angular from 'angular';\nimport Loader from 'angular-ecmascript/module-loader';\nimport { Meteor } from 'meteor/meteor';\n\n// Modules\nimport ChatsCtrl from '../controllers/chats.controller';\nimport ChatCtrl from '../controllers/chat.controller';\nimport ConfirmationCtrl from '../controllers/confirmation.controller';\nimport LoginCtrl from '../controllers/login.controller';\nimport NewChatCtrl from '../controllers/new-chat.controller';\nimport ProfileCtrl from '../controllers/profile.controller';\nimport SettingsCtrl from '../controllers/settings.controller';\nimport InputDirective from '../directives/input.directive';\nimport CalendarFilter from '../filters/calendar.filter';\nimport ChatNameFilter from '../filters/chat-name.filter';\nimport ChatPictureFilter from '../filters/chat-picture.filter';\nimport NewChatService from '../services/new-chat.service';\nimport Routes from '../routes';\n\nconst App = 'Whatsapp';\n\n// App\nAngular.module(App, [\n  'angular-meteor',\n  'angular-meteor.auth',\n  'angularMoment',\n  'ionic'\n]);\n\nnew Loader(App)\n  .load(ChatsCtrl)\n  .load(ChatCtrl)\n  .load(ConfirmationCtrl)\n  .load(LoginCtrl)\n  .load(NewChatCtrl)\n  .load(ProfileCtrl)\n  .load(SettingsCtrl)\n  .load(InputDirective)\n  .load(CalendarFilter)\n  .load(ChatNameFilter)\n  .load(ChatPictureFilter)\n  .load(NewChatService)\n  .load(Routes);\n\n// Startup\nif (Meteor.isCordova) {\n  Angular.element(document).on('deviceready', onReady);\n}\nelse {\n  Angular.element(document).ready(onReady);\n}\n\nfunction onReady() {\n  Angular.bootstrap(document, [App]);\n}\n","import Ionic from 'ionic-scripts';\nimport { _ } from 'meteor/underscore';\nimport { Meteor } from 'meteor/meteor';\nimport { MeteorCameraUI } from 'meteor/okland:camera-ui';\nimport { Controller } from 'angular-ecmascript/module-helpers';\nimport { Chats, Messages } from '../../../lib/collections';\n\nexport default class ChatCtrl extends Controller {\n  constructor() {\n    super(...arguments);\n\n    this.chatId = this.$stateParams.chatId;\n    this.isIOS = Ionic.Platform.isWebView() && Ionic.Platform.isIOS();\n    this.isCordova = Meteor.isCordova;\n\n    this.helpers({\n      messages() {\n        return Messages.find({ chatId: this.chatId });\n      },\n      data() {\n        return Chats.findOne(this.chatId);\n      }\n    });\n\n    this.autoScroll();\n  }\n\n  sendPicture() {\n    MeteorCameraUI.getPicture({}, (err, data) => {\n      if (err) return this.handleError(err);\n\n      this.callMethod('newMessage', {\n        picture: data,\n        type: 'picture',\n        chatId: this.chatId\n      });\n    });\n  }\n\n  sendMessage() {\n    if (_.isEmpty(this.message)) return;\n\n    this.callMethod('newMessage', {\n      text: this.message,\n      type: 'text',\n      chatId: this.chatId\n    });\n\n    delete this.message;\n  }\n\n  inputUp () {\n    if (this.isIOS) {\n      this.keyboardHeight = 216;\n    }\n\n    this.scrollBottom(true);\n  }\n\n  inputDown () {\n    if (this.isIOS) {\n      this.keyboardHeight = 0;\n    }\n\n    this.$ionicScrollDelegate.$getByHandle('chatScroll').resize();\n  }\n\n  closeKeyboard () {\n    if (this.isCordova) {\n      cordova.plugins.Keyboard.close();\n    }\n  }\n\n  autoScroll() {\n    let recentMessagesNum = this.messages.length;\n\n    this.autorun(() => {\n      const currMessagesNum = this.getCollectionReactively('messages').length;\n      const animate = recentMessagesNum != currMessagesNum;\n      recentMessagesNum = currMessagesNum;\n      this.scrollBottom(animate);\n    });\n  }\n\n  scrollBottom(animate) {\n    this.$timeout(() => {\n      this.$ionicScrollDelegate.$getByHandle('chatScroll').scrollBottom(animate);\n    }, 300);\n  }\n\n  handleError(err) {\n    if (err.error == 'cancel') return;\n    this.$log.error('Profile save error ', err);\n\n    this.$ionicPopup.alert({\n      title: err.reason || 'Save failed',\n      template: 'Please try again',\n      okType: 'button-positive button-clear'\n    });\n  }\n}\n\nChatCtrl.$name = 'ChatCtrl';\nChatCtrl.$inject = ['$stateParams', '$timeout', '$ionicScrollDelegate', '$ionicPopup', '$log'];\n","import { Controller } from 'angular-ecmascript/module-helpers';\nimport { Chats } from '../../../lib/collections';\n\nexport default class ChatsCtrl extends Controller {\n  constructor() {\n    super(...arguments);\n\n    this.helpers({\n      data() {\n        return Chats.find();\n      }\n    });\n  }\n\n  showNewChatModal() {\n    this.NewChat.showModal();\n  }\n\n  remove(chat) {\n    this.callMethod('removeChat', chat._id);\n  }\n}\n\nChatsCtrl.$name = 'ChatsCtrl';\nChatsCtrl.$inject = ['NewChat'];\n","import { _ } from 'meteor/underscore';\nimport { Accounts } from 'meteor/accounts-base';\nimport { Controller } from 'angular-ecmascript/module-helpers';\n\nexport default class ConfirmationCtrl extends Controller {\n  constructor() {\n    super(...arguments);\n\n    this.phone = this.$state.params.phone;\n  }\n\n  confirm() {\n    if (_.isEmpty(this.code)) return;\n\n    Accounts.verifyPhone(this.phone, this.code, (err) => {\n      if (err) return this.handleError(err);\n      this.$state.go('profile');\n    });\n  }\n\n  handleError(err) {\n    this.$log.error('Confirmation error ', err);\n\n    this.$ionicPopup.alert({\n      title: err.reason || 'Confirmation failed',\n      template: 'Please try again',\n      okType: 'button-positive button-clear'\n    });\n  }\n}\n\nConfirmationCtrl.$name = 'ConfirmationCtrl';\nConfirmationCtrl.$inject = ['$state', '$ionicPopup', '$log'];","import { _ } from 'meteor/underscore';\nimport { Accounts } from 'meteor/accounts-base';\nimport { Controller } from 'angular-ecmascript/module-helpers';\n\nexport default class LoginCtrl extends Controller {\n  login() {\n    if (_.isEmpty(this.phone)) return;\n\n    const confirmPopup = this.$ionicPopup.confirm({\n      title: 'Number confirmation',\n      template: '<div>' + this.phone + '</div><div>Is your phone number above correct?</div>',\n      cssClass: 'text-center',\n      okText: 'Yes',\n      okType: 'button-positive button-clear',\n      cancelText: 'edit',\n      cancelType: 'button-dark button-clear'\n    });\n\n    confirmPopup.then((res) => {\n      if (!res) return;\n\n      this.$ionicLoading.show({\n        template: 'Sending verification code...'\n      });\n\n      Accounts.requestPhoneVerification(this.phone, (err) => {\n        this.$ionicLoading.hide();\n        if (err) return this.handleError(err);\n        this.$state.go('confirmation', { phone: this.phone });\n      });\n    });\n  }\n\n  handleError(err) {\n    this.$log.error('Login error ', err);\n\n    this.$ionicPopup.alert({\n      title: err.reason || 'Login failed',\n      template: 'Please try again',\n      okType: 'button-positive button-clear'\n    });\n  }\n}\n\nLoginCtrl.$name = 'LoginCtrl';\nLoginCtrl.$inject = ['$state', '$ionicLoading', '$ionicPopup', '$log'];","import { Meteor } from 'meteor/meteor';\nimport { Controller } from 'angular-ecmascript/module-helpers';\nimport { Chats } from '../../../lib/collections';\n\nexport default class NewChatCtrl extends Controller {\n  constructor() {\n    super(...arguments);\n\n    this.subscribe('users');\n\n    this.helpers({\n      users() {\n        return Meteor.users.find({ _id: { $ne: this.currentUserId } });\n      }\n    });\n  }\n\n  newChat(userId) {\n    let chat = Chats.findOne({ userIds: { $all: [this.currentUserId, userId] } });\n\n    if (chat) {\n      this.hideNewChatModal();\n      return this.goToChat(chat._id);\n    }\n\n    this.callMethod('newChat', userId, (err, chatId) => {\n      this.hideNewChatModal();\n      if (err) return this.handleError(err);\n      this.goToChat(chatId);\n    });\n  }\n\n  hideNewChatModal() {\n    this.NewChat.hideModal();\n  }\n\n  goToChat(chatId) {\n    this.$state.go('tab.chat', { chatId });\n  }\n\n  handleError(err) {\n    this.$log.error('New chat creation error ', err);\n\n    this.$ionicPopup.alert({\n      title: err.reason || 'New chat creation failed',\n      template: 'Please try again',\n      okType: 'button-positive button-clear'\n    });\n  }\n}\n\nNewChatCtrl.$name = 'NewChatCtrl';\nNewChatCtrl.$inject = ['$state', 'NewChat', '$ionicPopup', '$log'];","import { _ } from 'meteor/underscore';\nimport { MeteorCameraUI } from 'meteor/okland:camera-ui';\nimport { Controller } from 'angular-ecmascript/module-helpers';\n\nexport default class ProfileCtrl extends Controller {\n  constructor() {\n    super(...arguments);\n\n    const profile = this.currentUser && this.currentUser.profile;\n    this.name = profile ? profile.name : '';\n  }\n\n  updatePicture () {\n    MeteorCameraUI.getPicture({ width: 60, height: 60 }, (err, data) => {\n      if (err) return this.handleError(err);\n\n      this.$ionicLoading.show({\n        template: 'Updating picture...'\n      });\n\n      this.callMethod('updatePicture', data, (err) => {\n        this.$ionicLoading.hide();\n        this.handleError(err);\n      });\n    });\n  }\n\n  updateName() {\n    if (_.isEmpty(this.name)) return;\n\n    this.callMethod('updateName', this.name, (err) => {\n      if (err) return this.handleError(err);\n      this.$state.go('tab.chats');\n    });\n  }\n\n  handleError(err) {\n    if (err.error == 'cancel') return;\n    this.$log.error('Profile save error ', err);\n\n    this.$ionicPopup.alert({\n      title: err.reason || 'Save failed',\n      template: 'Please try again',\n      okType: 'button-positive button-clear'\n    });\n  }\n}\n\nProfileCtrl.$name = 'ProfileCtrl';\nProfileCtrl.$inject = ['$state', '$ionicLoading', '$ionicPopup', '$log'];\n","import { Meteor } from 'meteor/meteor';\nimport { Controller } from 'angular-ecmascript/module-helpers';\n\nexport default class SettingsCtrl extends Controller {\n  logout() {\n    Meteor.logout((err) => {\n      if (err) return this.handleError(err);\n      this.$state.go('login');\n    })\n  }\n\n  handleError (err) {\n    this.$log.error('Settings modification error', err);\n\n    this.$ionicPopup.alert({\n      title: err.reason || 'Settings modification failed',\n      template: 'Please try again',\n      okType: 'button-positive button-clear'\n    });\n  }\n}\n\nSettingsCtrl.$inject = ['$state', '$ionicPopup', '$log'];","import { Directive } from 'angular-ecmascript/module-helpers';\n\nexport default class InputDirective extends Directive {\n  constructor() {\n    super(...arguments);\n\n    this.restrict = 'E';\n\n    this.scope = {\n      'returnClose': '=',\n      'onReturn': '&',\n      'onFocus': '&',\n      'onBlur': '&'\n    };\n  }\n\n  link(scope, element) {\n    element.bind('focus', (e) => {\n      if (!scope.onFocus) return;\n\n      this.$timeout(() => {\n        scope.onFocus();\n      });\n    });\n\n    element.bind('blur', (e) => {\n      if (!scope.onBlur) return;\n\n      this.$timeout(() => {\n        scope.onBlur();\n      });\n    });\n\n    element.bind('keydown', (e) => {\n      if (e.which != 13) return;\n\n      if (scope.returnClose) {\n        element[0].blur();\n      }\n\n      if (scope.onReturn) {\n        this.$timeout(() => {\n          scope.onReturn();\n        });\n      }\n    });\n  }\n}\n\nInputDirective.$name = 'input';\nInputDirective.$inject = ['$timeout'];","import Moment from 'moment';\nimport { Filter } from 'angular-ecmascript/module-helpers';\n\nexport default class CalendarFilter extends Filter {\n  filter(time) {\n    if (!time) return;\n\n    return Moment(time).calendar(null, {\n      lastDay : '[Yesterday]',\n      sameDay : 'LT',\n      lastWeek : 'dddd',\n      sameElse : 'DD/MM/YY'\n    });\n  }\n}\n\nCalendarFilter.$name = 'calendar';","import { _ } from 'meteor/underscore';\nimport { Meteor } from 'meteor/meteor';\nimport { Filter } from 'angular-ecmascript/module-helpers';\n\nexport default class ChatNameFilter extends Filter {\n  filter(chat) {\n    if (!chat) return;\n\n    let otherId = _.without(chat.userIds, Meteor.userId())[0];\n    let otherUser = Meteor.users.findOne(otherId);\n    let hasName = otherUser && otherUser.profile && otherUser.profile.name;\n\n    return hasName ? otherUser.profile.name : chat.name || 'NO NAME';\n  }\n}\n\nChatNameFilter.$name = 'chatName';\n","import { _ } from 'meteor/underscore';\nimport { Meteor } from 'meteor/meteor';\nimport { Filter } from 'angular-ecmascript/module-helpers';\n\nexport default class ChatPictureFilter extends Filter {\n  filter(chat) {\n    if (!chat) return;\n\n    let otherId = _.without(chat.userIds, Meteor.userId())[0];\n    let otherUser = Meteor.users.findOne(otherId);\n    let hasPicture = otherUser && otherUser.profile && otherUser.profile.picture;\n\n    return hasPicture ? otherUser.profile.picture : chat.picture || '/user-default.svg';\n  };\n}\n\nChatPictureFilter.$name = 'chatPicture';","import { Service } from 'angular-ecmascript/module-helpers';\n\nexport default class NewChatService extends Service {\n  constructor() {\n    super(...arguments);\n\n    this.templateUrl = 'client/templates/new-chat.html';\n  }\n\n  showModal() {\n    this.scope = this.$rootScope.$new();\n\n    this.$ionicModal.fromTemplateUrl(this.templateUrl, {\n      scope: this.scope\n    })\n    .then((modal) => {\n      this.modal = modal;\n      this.modal.show();\n    });\n  }\n\n  hideModal() {\n    this.scope.$destroy();\n    this.modal.remove();\n  }\n}\n\nNewChatService.$name = 'NewChat';\nNewChatService.$inject = ['$rootScope', '$ionicModal'];","import { _ } from 'meteor/underscore';\nimport { Meteor } from 'meteor/meteor';\nimport { Config, Runner } from 'angular-ecmascript/module-helpers';\n\nclass RoutesConfig extends Config {\n  constructor() {\n    super(...arguments);\n\n    this.isAuthorized = ['$auth', this.isAuthorized.bind(this)];\n  }\n\n  configure() {\n    this.$stateProvider\n      .state('tab', {\n        url: '/tab',\n        abstract: true,\n        templateUrl: 'client/templates/tabs.html',\n        resolve: {\n          user: this.isAuthorized,\n          chats() {\n            return Meteor.subscribe('chats');\n          }\n        }\n      })\n      .state('tab.chats', {\n        url: '/chats',\n        views: {\n          'tab-chats': {\n            templateUrl: 'client/templates/chats.html',\n            controller: 'ChatsCtrl as chats'\n          }\n        }\n      })\n      .state('tab.chat', {\n        url: '/chats/:chatId',\n        views: {\n          'tab-chats': {\n            templateUrl: 'client/templates/chat.html',\n            controller: 'ChatCtrl as chat'\n          }\n        }\n      })\n      .state('login', {\n        url: '/login',\n        templateUrl: 'client/templates/login.html',\n        controller: 'LoginCtrl as logger'\n      })\n      .state('confirmation', {\n        url: '/confirmation/:phone',\n        templateUrl: 'client/templates/confirmation.html',\n        controller: 'ConfirmationCtrl as confirmation'\n      })\n      .state('profile', {\n        url: '/profile',\n        templateUrl: 'client/templates/profile.html',\n        controller: 'ProfileCtrl as profile',\n        resolve: {\n          user: this.isAuthorized\n        }\n      })\n      .state('tab.settings', {\n        url: '/settings',\n        views: {\n          'tab-settings': {\n            templateUrl: 'client/templates/settings.html',\n            controller: 'SettingsCtrl as settings',\n          }\n        }\n      });\n\n    this.$urlRouterProvider.otherwise('tab/chats');\n  }\n\n  isAuthorized($auth) {\n    return $auth.awaitUser();\n  }\n}\n\nRoutesConfig.$inject = ['$stateProvider', '$urlRouterProvider'];\n\nclass RoutesRunner extends Runner {\n  run() {\n    this.$rootScope.$on('$stateChangeError', (...args) => {\n      const err = _.last(args);\n\n      if (err === 'AUTH_REQUIRED') {\n        this.$state.go('login');\n      }\n    });\n  }\n}\n\nRoutesRunner.$inject = ['$rootScope', '$state'];\n\nexport default [RoutesConfig, RoutesRunner];","import { Mongo } from 'meteor/mongo';\n\nexport const Chats = new Mongo.Collection('chats');\nexport const Messages = new Mongo.Collection('messages');","import { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport { Chats, Messages } from '../lib/collections';\n\nMeteor.methods({\n  newMessage(message) {\n    if (!this.userId) {\n      throw new Meteor.Error('not-logged-in',\n        'Must be logged in to send message.');\n    }\n\n    check(message, Match.OneOf(\n      {\n        text: String,\n        type: String,\n        chatId: String\n      },\n      {\n        picture: String,\n        type: String,\n        chatId: String\n      }\n    ));\n\n    message.timestamp = new Date();\n    message.userId = this.userId;\n\n    const messageId = Messages.insert(message);\n    Chats.update(message.chatId, { $set: { lastMessage: message } });\n\n    return messageId;\n  },\n  updateName(name) {\n    if (!this.userId) {\n      throw new Meteor.Error('not-logged-in',\n        'Must be logged in to update his name.');\n    }\n\n    check(name, String);\n\n    if (name.length === 0) {\n      throw Meteor.Error('name-required', 'Must provide a user name');\n    }\n\n    return Meteor.users.update(this.userId, { $set: { 'profile.name': name } });\n  },\n  newChat(otherId) {\n    if (!this.userId) {\n      throw new Meteor.Error('not-logged-in',\n        'Must be logged to create a chat.');\n    }\n\n    check(otherId, String);\n    const otherUser = Meteor.users.findOne(otherId);\n\n    if (!otherUser) {\n      throw new Meteor.Error('user-not-exists',\n        'Chat\\'s user not exists');\n    }\n\n    const chat = {\n      userIds: [this.userId, otherId],\n      createdAt: new Date()\n    };\n\n    const chatId = Chats.insert(chat);\n\n    return chatId;\n  },\n  removeChat(chatId) {\n    if (!this.userId) {\n      throw new Meteor.Error('not-logged-in',\n        'Must be logged to create a chat.');\n    }\n\n    check(chatId, String);\n\n    const chat = Chats.findOne(chatId);\n\n    if (!chat || !_.include(chat.userIds, this.userId)) {\n      throw new Meteor.Error('chat-not-exists',\n        'Chat not exists');\n    }\n\n    Messages.remove({ chatId: chatId });\n\n    return Chats.remove({ _id: chatId });\n  },\n  updatePicture(data) {\n    if (!this.userId) {\n      throw new Meteor.Error('not-logged-in',\n        'Must be logged in to update his picture.');\n    }\n\n    check(data, String);\n\n    return Meteor.users.update(this.userId, { $set: { 'profile.picture': data } });\n  }\n});"]}}]